const express = require("express");
const app = express();
const path = require("path");


const SECRET_FLAG = "flag{you8_c4ught#_m3%}";


app.use("/uploads", express.static(path.join(__dirname, "uploads")));


app.get("/", (req, res) => {
  res.sendFile(path.join(__dirname, "index.html"));
});


app.get("/fake_twitter.html", (req, res) => {
  res.sendFile(path.join(__dirname, "fake_twitter.html"));
});
app.get("/tour.html", (req, res) => {
  const filename = req.query.filename || "fort.jpg"; 

  res.send(`
    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <title>Rajasthan Tour</title>
      <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #fdf6e3; color: #333; }
        h1 { text-align: center; color: #b22222; }
        .image-box { display: flex; justify-content: center; margin-top: 20px; }
        img { max-width: 500px; border-radius: 10px; box-shadow: 0 0 8px rgba(0,0,0,0.3); }
        p { text-align: center; margin-top: 30px; font-style: italic; color: #444; }
        .links { text-align: center; margin-top: 30px; }
        .links a { margin: 0 10px; color: #1da1f2; text-decoration: none; font-weight: bold; }
        .links a:hover { text-decoration: underline; }
      </style>
    </head>
    <body>
      <h1>Rajasthan Tour</h1>
      <div class="image-box">
        <img src="/uploads/${filename}" alt="Beautiful Rajasthan Fort">
      </div>
      <p>Forts keep stories behind closed doors â€” only those who know where to look will find them.</p>

      <div class="links">
        <p>Explore more forts and hidden stories:</p>
        <a href="/tour.html?filename=fort.jpg">Main Rajasthan Fort</a> |
        <a href="/tour.html?filename=x" onerror="alert('Nothing here!')">Mysterious Desert</a> |
        <a href="/tour.html?filename=hidden" onerror="alert('Keep looking!')">Secret Palace</a> |
        <a href="/tour.html?filename=x" onerror="fetch('/secret').then(res=>res.text()).then(alert)">Forbidden Room</a>
      </div>
    </body>
    </html>
  `);
});


app.get("/secret", (req, res) => {
  res.type("text/plain").send(SECRET_FLAG);
});

// ==== Start server ====
const PORT = 5000;
app.listen(PORT, () => {
  console.log("Server running on http://localhost:" + PORT);
});
